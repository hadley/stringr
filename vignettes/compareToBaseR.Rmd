---
title: "Comparing stringr to base R"
author: "Sara Stoudt"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

[Solving this issue](https://github.com/tidyverse/stringr/issues/266) for tidy-dev-day.


`str_c`

```{r}
str_c("Letter: ", letters)
paste("Letter: ",letters,sep="")
```

```{r}
str_c("Letter", letters, sep = ": ")
paste("Letter", letters, sep = ": ")
```

`str_conv`



`str_count`

```{r}
fruit <- c("apple", "banana", "pear", "pinapple")

str_count(fruit, "a")
str_count(fruit, "p")
str_count(fruit, "e")
str_count(c("a.", "...", ".a.a"), ".")


countCharOccurrences <- function(char, s) {
    s2 <- gsub(char,"",s)
    return (nchar(s) - nchar(s2))
}#https://techoverflow.net/2012/11/10/r-count-occurrences-of-character-in-string/
## maybe need to change this to length instead of nchar, see str_length

countCharOccurrences("a",fruit)
countCharOccurrences("p",fruit)
countCharOccurrences("e",fruit)
countCharOccurrences(".",c("a.", "...", ".a.a"))
```


```{r}
## difference
str_count(fruit, c("a", "b", "p", "p"))
str_count(c("a.", "...", ".a.a"), fixed("."))

lapply(c("a", "b", "p", "p"),countCharOccurrences,fruit)
countCharOccurrences(fixed("."),c("a.", "...", ".a.a"))
```


`str_detect`

```{r}
str_detect(fruit, "a")
grepl("a", fruit)

str_detect(fruit, "^a")
grepl("^a", fruit)

str_detect(fruit, "a$")
grepl("a$", fruit)

str_detect(fruit, "b")
grepl("b", fruit)

str_detect(fruit, "[aeiou]")
grepl("[aeiou]", fruit)
```

```{r}
## difference
str_detect("aecfg", letters)
grepl("aecfg", letters)

lapply(unlist(str_split("aecfg","")),function(x){grepl(x,letters)}) 
## TO DO: need to collaps via "or"
```


`str_dup`

```{r}
fruit <- c("apple", "pear", "banana")
str_dup(fruit, 2)
str_dup(fruit, 1:3)
str_c("ba", str_dup("na", 0:5))


#https://stackoverflow.com/questions/22359127/how-to-repeat-a-string-n-times-in-r
unlist(lapply(lapply(fruit,function(x){replicate(2,x)}),paste,collapse=""))

unlist(lapply(mapply(function(x,y){replicate(x,y)},1:3,fruit),paste,collapse=""))

paste("ba",unlist(lapply(lapply(0:5,function(x){replicate(x,"na")}),paste,collapse="")),sep="")
```

`str_extract`

```{r}
shopping_list <- c("apples x4", "bag of flour", "bag of sugar", "milk x2")
str_extract(shopping_list, "\\d")
str_extract(shopping_list, "[a-z]+")

#https://stackoverflow.com/questions/47678725/how-to-do-str-extract-with-base-r
```

`str_flatten`

```{r}
str_flatten(letters)
paste(letters,collapse="")

str_flatten(letters, "-")
paste(letters,"-",sep="",collapse="")
```

`str_glue`

```{r}
name <- "Fred"
age <- 50
anniversary <- as.Date("1991-10-12")
str_glue(
"My name is {name}, ",
"my age next year is {age + 1}, ",
"and my anniversary is {format(anniversary, '%A, %B %d, %Y')}."
)


paste("My name is ",eval(name),", my age next year is ",eval(age+1),", and my anniversary is ",eval(format(anniversary, '%A, %B %d, %Y')),".",sep="")
```

`str_length`

```{r}
str_length(letters)
nchar(letters)

str_length(NA)
nchar(NA)

str_length(c("i", "like", "programming", NA))
nchar(c("i", "like", "programming", NA))
```

```{r}
## difference
str_length(factor("abc"))
nchar(factor("abc")) ## Error in nchar(factor("abc")) : 'nchar()' requires a character vector
```

```{r}
u1 <- "\u00fc"
u2 <- stringi::stri_trans_nfd(u1)
# The print the same:
u1
u2
# But have a different length
str_length(u1)
str_length(u2)
# Even though they have the same number of characters
str_count(u1)
str_count(u2)

nchar(u1) ## matches length not count
nchar(u2)

length(u1) ## weird
length(u2)
```


`str_locate`

```{r}
fruit <- c("apple", "banana", "pear", "pineapple")
str_locate(fruit, "$")
# "If the match is of length 0, (e.g. from a special match like $) end will be one character less than start."

str_locate(fruit, "a")
str_locate(fruit, "e")
str_locate(fruit, "ap") ## adding this

str_locate(fruit, c("a", "b", "p", "p"))

gregexpr("$",fruit) ## ## get stuff out

gregexpr("a",fruit)

gregexpr("e",fruit) ## -1 is the NA
gregexpr("ap",fruit)

mapply(gregexpr,c("a", "b", "p", "p"),fruit)
```

`str_match`


`str_order`

```{r}
str_order(letters)
str_sort(letters)

order(letters)
sort(letters)
```

```{r}
str_order(letters, locale = "haw") ## vowels come first
str_sort(letters, locale = "haw")
## no locale capability in order, sort
```

```{r}
x <- c("100a10", "100a5", "2b", "2a")
str_sort(x)
str_sort(x, numeric = TRUE)

sort(x)
## no numeric capability in sort
```

`str_pad`

```{r}
rbind(
str_pad("hadley", 30, "left"),
str_pad("hadley", 30, "right"),
str_pad("hadley", 30, "both")
)

sprintf("%30s","hadley")
sprintf("%-30s","hadley")

leftover=30-nchar("hadley")
leftpad=nchar("hadley")+floor(leftover/2)

rbind(sprintf("%30s","hadley"),
sprintf("%-30s","hadley"),
sprintf("%-30s",sprintf(paste("%",leftpad,"s",sep=""),"hadley"))
)
```


`str_remove`
`str_replace`
`str_replace_na`
`str_split`
`str_sub`
`str_subset`
`str_trim`
`str_trunc`
`str_view`
`str_wrap`
